# CNN Model Analysis

This project contains experiments and models to explore various configurations and techniques for convolutional neural networks (CNNs) in computer vision tasks. The project includes hyperparameter tuning, model compression analysis, and model comparison experiments.

## Project Structure

```
CNN_ml4cv/
├── data/                  # Folder containing dataset
├── experiments/           # Contains scripts for experiments
│   ├── compression_analysis.py
│   ├── hyperparameter_tuning.py
│   ├── loss_comparison.py
│   ├── model_comparison.py
├── models/                # Contains model implementations
│   ├── pretrainedmodel.py
│   ├── simplemodel.py
├── plots/                 # Folder for generated plots
├── results/               # Folder to store results of experiments
├── utils/                 # Utility scripts
│   ├── dataloader.py
│   ├── training.py
├── main.py                # Entry point for running experiments
```

## Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/your-username/CNN_ml4cv.git
   cd CNN_ml4cv
   ```

2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

## Usage

Run the `main.py` script with the desired experiment and results directory:

```bash
python main.py --experiment <experiment_name> --results_dir <results_directory>
```

### Available Experiments

- `num_layers` - Analyze the impact of the number of layers in the SimpleModel.
- `kernel_sizes` - Explore different kernel sizes for convolution layers.
- `skip_connections` - Experiment with and without skip connections.
- `normalisation` - Test the effect of different normalization strategies.
- `dropout` - Study the influence of dropout rates.
- `weight_decay` - Examine the impact of L2 regularization.
- `learning_rates` - Tune learning rates for optimal training performance.
- `batch_sizes` - Compare training using different batch sizes.
- `optimizer_types` - Experiment with various optimizers (e.g., SGD, Adam).
- `hyperparameter_tuning` - Perform full hyperparameter tuning for the SimpleModel.
- `loss_comparison` - Compare different loss functions.
- `compression_analysis` - Perform singular value decomposition (SVD) for model compression.
- `model_comparison` - Compare performance of a scratch-built HCNN vs a pretrained model.

### Example Commands

- To run a loss comparison experiment:
  ```bash
  python main.py --experiment loss_comparison --results_dir results/loss_comparison
  ```

- To perform hyperparameter tuning:
  ```bash
  python main.py --experiment hyperparameter_tuning --results_dir results/hyperparameter_tuning
  ```

## Results and Plots

All results and plots generated by experiments will be saved in the directory specified by `--results_dir`.

## Dataset

The project assumes the dataset is stored in the `data/` folder with the structure:
```
data/
└── 101_ObjectCategories/
    ├── class_1/
    ├── class_2/
    ├── ...
```

